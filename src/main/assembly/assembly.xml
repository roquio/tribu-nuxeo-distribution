<assembly
	xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2 http://maven.apache.org/xsd/assembly-1.1.2.xsd">
	<id>bin</id>
	<formats>
		<format>zip</format>
	</formats>
	<includeBaseDirectory>false</includeBaseDirectory>

	<dependencySets>

		<dependencySet>
			<outputDirectory>/${artifactId}-${project.version}/nxserver/plugins
			</outputDirectory>
			<unpack>false</unpack>
			<scope>runtime</scope>
			<includes>
				<!-- OpenToutatice -->
				<include>opentoutatice-ecm.platform:opentoutatice-ecm-platform-attached-files:jar:${opentoutatice.version}
				</include>
				<include>opentoutatice-ecm.platform:opentoutatice-ecm-platform-automation:jar:${opentoutatice.version}
				</include>
				<include>opentoutatice-ecm.platform:opentoutatice-ecm-platform-core:jar:${opentoutatice.version}
				</include>
				<include>opentoutatice-ecm.platform:opentoutatice-core-type-enricher:jar:${opentoutatice.version}
                </include>
				<include>opentoutatice-ecm.platform:opentoutatice-ecm-platform-services:jar:${opentoutatice.version}
				</include>
				<include>opentoutatice-ecm.platform:opentoutatice-ecm-platform-web:jar:${opentoutatice.version}
				</include>
				<include>opentoutatice-ecm.platform:opentoutatice-ecm-platform-reporting:jar:${opentoutatice.version}
                </include>
				<include>opentoutatice-ecm.platform:opentoutatice-ecm-platform-probes:jar:${opentoutatice.version}
                </include>                

				<!-- Add ons -->
				<include>opentoutatice-ecm.elasticsearch:opentoutatice-addon-elasticsearch-ecm:jar:${ottc.es.version}
				</include>
				<include>opentoutatice-ecm.file-based-naming:opentoutatice-addon-file-based-naming-ecm:jar:${ottc.filenaming.version}
				</include>
				<include>opentoutatice-ecm.portal-notifications:opentoutatice-addon-portal-notifications-ecm:jar:${ottc.notif.version}
				</include>
				<include>opentoutatice-ecm.collab-tools:opentoutatice-collab-tools-ecm:jar:${ottc.collab.version}
				</include>
				<!-- <include>opentoutatice-ecm.drive:opentoutatice-drive:jar:${ottc.drive.version} 
					</include> -->
				<include>opentoutatice-ecm.generic-ui-service:opentoutatice-generic-ui-service-ecm:jar:${ottc.generic-ui.version}
				</include>
				<include>opentoutatice-ecm.elasticsearch-customizer:opentoutatice-addon-elasticsearch-customizer-ecm:jar:${ottc.es.custom.version}
				</include>
				<include>opentoutatice-ecm.procedures:opentoutatice-addon-procedures-ecm:jar:${ottc.procedure.version}
				</include>
				<include>opentoutatice-ecm.monitoring:opentoutatice-monitoring-ecm:jar:${ottc.monitoring.version}
                </include>
				<include>opentoutatice-ecm.jwt:opentoutatice-addon-jwt-ecm:jar:${ottc.jwt.version}
                </include>
				<include>opentoutatice-ecm.onlyoffice:opentoutatice-addon-onlyoffice-ecm:jar:${ottc.onlyoffice.version}
                </include>
				<include>opentoutatice-ecm.file-versioning:opentoutatice-addon-file-versioning-ecm:jar:${ottc.file.versioning.version}
                </include>
				<!-- <include>opentoutatice-ecm.ui:opentoutatice-addon-simple-ui-ecm:jar:${ottc.ui.version} 
					</include> -->
				<include>opentoutatice-ecm.news:opentoutatice-addon-news-ecm:jar:${ottc.news.version}
                </include>
                <include>opentoutatice-ecm.migrations:opentoutatice-addon-migration:jar:${ottc.migration.version}
                </include>

				<include>opentoutatice-ecm.profiled-publishing:opentoutatice-platform-profiled-publishing-ecm:jar:${ottc.profiledpublishing.version}
                </include>
				<include>opentoutatice-ecm.remote-publishing:opentoutatice-platform-remote-publishing-ecm:jar:${ottc.remotepublishing.version}
                </include>
				<include>opentoutatice-ecm.web-mode:opentoutatice-web-mode-ecm:jar:${ottc.webmode.version}
                </include>
				<include>opentoutatice-ecm.sharing:opentoutatice-sharing:jar:${ottc.sharing.version}</include>

				<!-- Ac rennes -->
				<include>toutatice-ecm.acrennes:toutatice-ecm-acrennes-adaptor:jar:${acrennes.version}
                </include>
				<include>toutatice-ecm.acrennes:toutatice-ecm-acrennes-automation:jar:${acrennes.version}
                </include>
				<include>toutatice-ecm.acrennes:toutatice-ecm-acrennes-core:jar:${acrennes.version}
                </include>
				<include>toutatice-ecm.acrennes:toutatice-ecm-acrennes-studio:jar:${acrennes.version}
                </include>
				<include>toutatice-ecm.acrennes:toutatice-ecm-acrennes-web:jar:${acrennes.version}
                </include>

				<include>toutatice-acrennes-addons.shortname:toutatice-acrennes-addons-shortname-ecm:jar:${shortname.version}
                </include>
				<include>toutatice-acrennes-addons.toutapad:toutatice-acrennes-addons-toutapad-ecm:jar:${toutapad.version}
                </include>
				<include>toutatice-services.climat:toutatice-climat-ecm:jar:${climat.version}
                </include>
				<include>toutatice-services.cst:toutatice-cst-ecm:jar:${cst.version}
                </include>
				<include>toutatice-services.depotConfidentiel:toutatice-dco-ecm:jar:${dco.version}
                </include>
				<include>toutatice-services.ficheslogiciels:toutatice-ficheslogiciels-ecm:jar:${ficheslogiciels.version}
                </include>
				<include>toutatice-services.listeemargement:toutatice-listeemargement-ecm:jar:${listeemargement.version}
                </include>
				<include>toutatice-services.merens:toutatice-merens-ecm:jar:${merens.version}
                </include>
				<include>toutatice-services.mpe:toutatice-mpe-ecm:jar:${mpe.version}
                </include>
				<include>toutatice-services.p1d:toutatice-p1d-ecm:jar:${p1d.version}
                </include>
				<include>toutatice-services.publidoc:toutatice-publidoc-ecm:jar:${publidoc.version}
                </include>
				<include>toutatice-services.uar:toutatice-uar-ecm:jar:${uar.version}
                </include>
				
				<include>fr.toutatice.simpleblog.ecm:toutatice-simpleblog-ecm:jar:${simpleblog.version}
				</include>

				<!-- Studio -->
				<include>acaren-nuxeo-studio:ACRENNES3:jar:${ACRENNES3.version}
                </include>
				<include>toutatice-services.acrennes-nuxeo-marketplaces:acrennes4:jar:${ACRENNES4.version}
                </include>
				<include>acaren-nuxeo-studio:ACRENNES6:jar:${ACRENNES6.version}
                </include>

				<!-- Login & SSO -->
				<include>org.nuxeo.ecm.platform:nuxeo-platform-login-portal-sso:jar:${nuxeo.version}
				</include>
			</includes>
		</dependencySet>

		<dependencySet>
			<outputDirectory>/${artifactId}-${project.version}/nxserver/bundles
			</outputDirectory>
			<unpack>false</unpack>
			<scope>runtime</scope>
			<includes>
				<!-- Nuxeo Agenda -->
				<include>org.nuxeo.ecm.platform:nuxeo-agenda:jar:${nuxeo.version}
				</include>
				<!-- DAM -->
				<include>org.nuxeo.ecm.annot:nuxeo-annot-api:jar:${nuxeo.version}
				</include>
				<include>org.nuxeo.ecm.annot:nuxeo-annot-contrib:jar:${nuxeo.version}
				</include>
				<include>org.nuxeo.ecm.annot:nuxeo-annot-core:jar:${nuxeo.version}
				</include>
				<include>org.nuxeo.ecm.annot:nuxeo-annot-gwt:jar:${nuxeo.version}
				</include>
				<include>org.nuxeo.ecm.annot:nuxeo-annot-http:jar:${nuxeo.version}
				</include>
				<include>org.nuxeo.ecm.annot:nuxeo-annot-repo:jar:${nuxeo.version}
				</include>
				<!-- <include>org.nuxeo.dam:nuxeo-dam:jar:${nuxeo.version} </include> -->


				<!-- Nuxeo Imaging -->
				<include>org.nuxeo.ecm.platform:nuxeo-platform-imaging-api:jar:${nuxeo.version}
				</include>
				<include>org.nuxeo.ecm.platform:nuxeo-platform-imaging-convert:jar:${nuxeo.version}
				</include>
				<include>org.nuxeo.ecm.platform:nuxeo-platform-imaging-core:jar:${nuxeo.version}
				</include>
				<include>org.nuxeo.ecm.platform:nuxeo-platform-imaging-dm:jar:${nuxeo.version}
				</include>
				<include>org.nuxeo.ecm.platform:nuxeo-platform-imaging-jsf:jar:${nuxeo.version}
				</include>
				<include>org.nuxeo.ecm.platform:nuxeo-platform-imaging-preview:jar:${nuxeo.version}
				</include>
				<include>org.nuxeo.ecm.platform:nuxeo-platform-imaging-tiling:jar:${nuxeo.version}
				</include>
				<include>org.nuxeo.ecm.platform:nuxeo-platform-imaging-tiling-preview:jar:${nuxeo.version}
				</include>
				<!-- Audio -->
				<include>org.nuxeo.ecm.platform:nuxeo-platform-audio-core:jar:${nuxeo.version}
				</include>
				<include>org.nuxeo.ecm.platform:nuxeo-platform-audio-jsf:jar:${nuxeo.version}
				</include>
				<!-- Video -->
				<include>org.nuxeo.ecm.platform:nuxeo-platform-video-api:jar:${nuxeo.version}
                </include>
				<include>org.nuxeo.ecm.platform:nuxeo-platform-video-core:jar:${nuxeo.version}
                </include>
				<include>org.nuxeo.ecm.platform:nuxeo-platform-video-convert:jar:${nuxeo.version}
                </include>
				<include>org.nuxeo.ecm.platform:nuxeo-platform-video-jsf:jar:${nuxeo.version}
                </include>
				<!-- Webengine -->
				<include>org.nuxeo.ecm.webengine:nuxeo-webengine-blogs:jar:${nuxeo.version}
				</include>
				<include>org.nuxeo.ecm.webengine:nuxeo-webengine-blogs-api:jar:${nuxeo.version}
				</include>
				<include>org.nuxeo.ecm.webengine:nuxeo-webengine-blogs-core:jar:${nuxeo.version}
				</include>
				<include>org.nuxeo.ecm.webengine:nuxeo-webengine-sites:jar:${nuxeo.version}
				</include>
				<include>org.nuxeo.ecm.webengine:nuxeo-webengine-sites-api:jar:${nuxeo.version}
				</include>
				<include>org.nuxeo.ecm.webengine:nuxeo-webengine-sites-core-contrib:jar:${nuxeo.version}
				</include>
				<!-- Login & SSO -->
				<include>org.nuxeo.ecm.platform:nuxeo-platform-login-cas2:jar:${nuxeo.version}
				</include>
				<!-- Platform explorer -->
				<include>org.nuxeo.ecm.platform:nuxeo-apidoc-core:jar:${nuxeo.version}
				</include>
				<include>org.nuxeo.ecm.platform:nuxeo-apidoc-webengine:jar:${nuxeo.version}
				</include>
				<include>org.nuxeo.ecm.webengine:nuxeo-webengine-ui:jar:${nuxeo.version}
				</include>

				<!-- Virtual navigation -->
				<include>org.nuxeo.ecm.platform:nuxeo-platform-virtualnavigation-core-contrib:jar:${nuxeo.version}
				</include>
				<include>org.nuxeo.ecm.platform:nuxeo-platform-virtualnavigation-web:jar:${nuxeo.version}
				</include>

				<!-- Faceted search -->
				<include>org.nuxeo.ecm.platform:nuxeo-platform-faceted-search-api:jar:${nuxeo.version}
				</include>
				<include>org.nuxeo.ecm.platform:nuxeo-platform-faceted-search-dm:jar:${nuxeo.version}
				</include>
				<include>org.nuxeo.ecm.platform:nuxeo-platform-faceted-search-jsf:jar:${nuxeo.version}
				</include>

				<!-- IMAP -->
				<include>org.nuxeo.ecm.platform:nuxeo-platform-mail-core:jar:${nuxeo.version}
				</include>
				<include>org.nuxeo.ecm.platform:nuxeo-platform-mail-types:jar:${nuxeo.version}
				</include>
				<include>org.nuxeo.ecm.platform:nuxeo-platform-mail-web:jar:${nuxeo.version}
				</include>
			</includes>
		</dependencySet>


		<dependencySet>
			<outputDirectory>/${artifactId}-${project.version}/nxserver/lib
			</outputDirectory>
			<unpack>false</unpack>
			<scope>runtime</scope>
			<includes>
				<!-- Dependencies for imaging -->
				<include>net.java.dev.mistral:EditableImage:jar:0.9.5
				</include>
				<include>com.google.gwt:gwt-servlet:jar:2.5.1
				</include>
				<include>org:jaudiotagger:jar:2.0.3
				</include>
				<include>com.drewnoakes:metadata-extractor:jar:2.3.1
				</include>
				<include>net.java.dev.mistral:Operations:jar:0.9.5
				</include>
				<include>org.jsoup:jsoup:jar:1.6.3
				</include>
				<!-- Dependencies for Java Melody monitoring -->
				<include>net.bull.javamelody:javamelody-core:jar:${javamelody.version}
                </include>
				<include>org.jrobin:jrobin:jar:1.5.9
                </include>
                

                <include>com.phloc:phloc-commons:jar:4.3.2
                </include>                
                
				<!-- Dependencides for etherpad client -->
				<include>org:etherpad_lite_client:jar:1.2.7
                </include>
				<include>com.googlecode.json-simple:json-simple:jar:1.1.1
                </include>
				<!-- Dependencides for jwt/onlyoffice -->
				<include>com.auth0:java-jwt:jar:3.3.0</include>
				<include>com.fasterxml.jackson.core:jackson-core:jar:2.9.2</include>
				<include>com.fasterxml.jackson.core:jackson-databind:jar:2.9.2</include>
				<include>com.fasterxml.jackson.core:jackson-annotations:jar:2.9.2</include>
			</includes>
		</dependencySet>

		<!-- Tomcat libs -->
		<dependencySet>
			<outputDirectory>/${artifactId}-${project.version}/lib
			</outputDirectory>
			<unpack>false</unpack>
			<scope>runtime</scope>
			<includes>
				<!-- Logs -->
				<include>org.apache.logging.log4j:log4j-api:jar:${log4j.version}</include>
				<include>org.apache.logging.log4j:log4j-core:jar:${log4j.version}</include>
				<include>org.apache.logging.log4j:log4j-jcl:jar:${log4j.version}</include>
				<include>org.apache.logging.log4j:log4j-1.2-api:jar:${log4j.version}</include>
				<include>org.apache.logging.log4j:log4j-slf4j-impl:jar:${log4j.version}</include>
			</includes>
		</dependencySet>
	</dependencySets>


	<fileSets>
		<!-- Socle -->
		<fileSet>
			<outputDirectory>/${artifactId}-${project.version}
			</outputDirectory>
			<directory>target/nuxeo-distrib/nuxeo-cap-${nuxeo.version}-tomcat</directory>
			<includes>
				<include>**</include>
			</includes>
			<!-- Surcharges -->
			<excludes>
				<!-- log4j -->
				<exclude>lib/log4j.xml</exclude>
				<exclude>lib/log4j-1.2.17.jar</exclude>
				<exclude>lib/slf4j-log4j12-1.7.5.jar</exclude>
				<!-- Services Nx -->
				<exclude>templates/common/config/blacklist.nxftl</exclude>
			</excludes>
		</fileSet>

		<!-- Templates -->
		<fileSet>
			<outputDirectory>/${artifactId}-${project.version}</outputDirectory>
			<directory>src/main/resources</directory>
		</fileSet>
	</fileSets>

</assembly>
